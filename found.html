<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Findero â€” Found Item</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:"Inter",sans-serif;background:#f5f7fa;color:#111}
header{background:#dcdcdc;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 4px 10px rgba(0,0,0,0.06)}
header img{height:95px;animation:fadeDown .45s ease}
@keyframes fadeDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.container{max-width:720px;margin:36px auto;padding:20px}
h1{text-align:center;color:#1d4ed8;margin-bottom:16px}
label{display:block;margin-top:12px;font-weight:600}
input,textarea{width:100%;padding:12px;margin-top:6px;border-radius:10px;border:1px solid #ccc;font-size:15px;background:#fff}
textarea{height:120px;resize:none}
.btn-submit{width:100%;margin-top:20px;padding:14px;background:#ff7a00;color:#fff;font-weight:700;border:none;border-radius:12px;cursor:pointer;transition:.2s}
.btn-submit:hover{background:#e06d00;transform:scale(1.05)}
.error{background:#fff6f6;border:1px solid #ffd6d6;color:#b00020;padding:12px;border-radius:10px;text-align:center;margin-top:12px}
footer{background:#1d4ed8;color:#fff;text-align:center;padding:14px;position:fixed;left:0;right:0;bottom:0}
.logout{background:#1d4ed8;color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer}
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="firebase.js"></script>

<script>
auth.onAuthStateChanged(user=>{ if(!user) window.location.href='login.html'; });
function logout(){ auth.signOut().then(()=>window.location.href='login.html'); }

async function submitFound(event){
    event.preventDefault();
    const name=document.getElementById('itemName').value.trim();
    const location=document.getElementById('locationFound').value.trim();
    const date=document.getElementById('dateFound').value;
    const desc=document.getElementById('description').value.trim();
    const file=document.getElementById('imageUpload').files[0];
    const errorDiv=document.getElementById('error');
    errorDiv.innerHTML='';

    if(!name||!location||!date){ errorDiv.innerText='Please fill all required fields.'; return; }

    try{
        const trackingId=Math.random().toString(36).substr(2,9);
        let imageUrl='';
        if(file){
            const storageRef=storage.ref().child(`foundImages/${trackingId}_${file.name}`);
            await storageRef.put(file);
            imageUrl=await storageRef.getDownloadURL();
        }
        await db.collection('foundItems').doc(trackingId).set({
            itemName:name,
            locationFound:location,
            dateFound:date,
            description:desc,
            imageUrl:imageUrl,
            trackingId:trackingId,
            timestamp:firebase.firestore.FieldValue.serverTimestamp()
        });
        alert('Found item submitted! Tracking ID: '+trackingId);
        document.getElementById('foundForm').reset();
    }catch(err){ errorDiv.innerText=err.message; }
}
</script>
</head>
<body>
<header>
<img src="assets/logo.png" alt="Findero Logo">
<button class="logout" onclick="logout()">Logout</button>
</header>

<main class="container">
<h1>Submit Found Item</h1>
<div id="error" class="error"></div>
<form id="foundForm" onsubmit="submitFound(event)">
<label>Item Name</label>
<input type="text" id="itemName" placeholder="Example: iPhone, Keys, Backpack">
<label>Location Found</label>
<input type="text" id="locationFound" placeholder="Example: Library, School Gate">
<label>Date Found</label>
<input type="date" id="dateFound">
<label>Description</label>
<textarea id="description" placeholder="Describe the item..."></textarea>
<label>Upload Image (optional)</label>
<input type="file" id="imageUpload" accept="image/*">
<button class="btn-submit" type="submit">Submit Found Item</button>
</form>
</main>

<footer>&copy; 2025 Findero. All rights reserved.</footer>
</body>
</html>
